ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team), legend = FALSE)
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
theme(legend.position = "none")
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
theme(legend.position = "none") + scale_color_fivethirtyeight() +
theme_fivethirtyeight()
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight(legend.position = "none")
?theme_fivethirtyeight
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none")
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none", axis.text.x = element_text(angle = 45,
hjust = 1))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 1))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 2))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 4))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5)) +
coord_flip()
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
## Created by: Eric William Shannon, PhD
## Date modified: 20190303
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190303.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
conference_effect <- lme4::lmer(srs ~ sos + w_l_percent + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
scores2$simulated <- simulate(conference_effect, seed = 1, newdata = scores2,
allow.new.levels = TRUE, re.form = NA, cond.sim = FALSE)$sim_1
scores2 <- scores2 %>% select(V1, V2, OFFENSE, DEFENSE, simulated)
scores2 <- scores2 %>%
mutate(simulatedR = dense_rank(desc(simulated))) %>%
column_to_rownames('V1')
scores2 <- scores2 %>%
rownames_to_column('team')
scores2$simulated <- scale(scores2$simulated)
scores2 <-
scores2 %>% mutate_at(vars(OFFENSE, DEFENSE, simulated), funs(round(. , 3)))
champs <- scores2 %>%
group_by(V2) %>% top_n(1, simulated)
at_large <- scores2 %>% filter(team %!in% champs$team) %>%
top_n(35, simulated)
ncaa_predicts <- bind_rows(champs, at_large)
ncaa_predicts %>% group_by(V2) %>% count(V2, sort = TRUE)
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = simulated)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = V2)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
?geom_Bar
?geom_bar
## Created by: Eric William Shannon, PhD
## Date modified: 20190307
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190307.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
conference_effect <- lme4::lmer(srs ~ sos + w_l_percent + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
scores2$simulated <- simulate(conference_effect, seed = 1, newdata = scores2,
allow.new.levels = TRUE, re.form = NA, cond.sim = FALSE)$sim_1
scores2 <- scores2 %>% select(V1, V2, OFFENSE, DEFENSE, simulated)
scores2 <- scores2 %>%
mutate(simulatedR = dense_rank(desc(simulated))) %>%
column_to_rownames('V1')
scores2 <- scores2 %>%
rownames_to_column('team')
scores2$simulated <- scale(scores2$simulated)
scores2 <-
scores2 %>% mutate_at(vars(OFFENSE, DEFENSE, simulated), funs(round(. , 3)))
ggplot(scores2, aes(V2, simulated)) +
geom_boxplot() + theme(axis.text.x = element_text(angle = 65, vjust = 0.6)) +
labs(title = "NCAA Conferences",
caption = "Source: EWS",
x = "",
y = "Simulated Metric") + scale_color_fivethirtyeight() +
theme_fivethirtyeight() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
champs <- scores2 %>%
group_by(V2) %>% top_n(1, simulated)
at_large <- scores2 %>% filter(team %!in% champs$team) %>%
top_n(35, simulated)
ncaa_predicts <- bind_rows(champs, at_large)
ncaa_predicts %>% group_by(V2) %>% count(V2, sort = TRUE)
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5)) +
geom_hline(yintercept = 1.298176, linetype = "dashed", alpha = 0.5)
ggplot(ncaa_predicts, aes(team, simulated)) +
geom_bar(stat = "identity", aes(fill = team)) +
scale_color_fivethirtyeight() + theme_fivethirtyeight() +
theme(legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1, size = 5))
## Created by: Eric William Shannon, PhD
## Date modified: 20190307
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190307.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
biplot.psych(pr_offense)
corplot(offense_data)
corPlot(offense_data)
o <- cor(offense_data)
library(corrplot)
install.packages("corrplot")
corplot(o)
library(corrplot)
corplot(o)
corrplot(o)
corrplot(o, method = "number")
corrplot(o, method = "number", type = "upper")
corrplot(o, method = "color", type = "upper")
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
conference_effect <- lme4::lmer(srs ~ sos + w_l_percent + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
scores2$simulated <- simulate(conference_effect, seed = 1, newdata = scores2,
allow.new.levels = TRUE, re.form = NA, cond.sim = FALSE)$sim_1
scores2 <- scores2 %>% select(V1, V2, OFFENSE, DEFENSE, simulated)
scores2 <- scores2 %>%
mutate(simulatedR = dense_rank(desc(simulated))) %>%
column_to_rownames('V1')
scores2 <- scores2 %>%
rownames_to_column('team')
scores2$simulated <- scale(scores2$simulated)
scores2 <-
scores2 %>% mutate_at(vars(OFFENSE, DEFENSE, simulated), funs(round(. , 3)))
ggplot(scores2, aes(V2, simulated)) +
geom_boxplot() + theme(axis.text.x = element_text(angle = 65, vjust = 0.6)) +
labs(title = "NCAA Conferences",
caption = "Source: EWS",
x = "",
y = "Simulated Metric") + scale_color_fivethirtyeight() +
theme_fivethirtyeight() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
## Created by: Eric William Shannon, PhD
## Date modified: 20190314
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190314.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(opp, stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
conference_effect <- lme4::lmer(srs ~ sos + w_l_percent + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
scores2$simulated <- simulate(conference_effect, seed = 1, newdata = scores2,
allow.new.levels = TRUE, re.form = NA, cond.sim = FALSE)$sim_1
scores2 <- scores2 %>% select(V1, V2, OFFENSE, DEFENSE, simulated)
scores2 <- scores2 %>%
mutate(simulatedR = dense_rank(desc(simulated))) %>%
column_to_rownames('V1')
scores2 <- scores2 %>%
rownames_to_column('team')
scores2$simulated <- scale(scores2$simulated)
scores2 <-
scores2 %>% mutate_at(vars(OFFENSE, DEFENSE, simulated), funs(round(. , 3)))
scores2 %>% filter(V2 = "A-10") %>%
ggplot(simulated) + geom_density()
scores2 %>% filter(V2 == "A-10") %>%
ggplot(simulated) + geom_density()
scores2 %>% filter(V2 == "A-10") %>%
ggplot(., aes(simulated)) + geom_density()
scores2 %>% filter(V2 == "A-10") %>%
ggplot(., aes(simulated)) + geom_density() + geom_vline(xintercept = c(-0.151, 0.738))
scores2 %>% filter(V2 == "A-10") %>%
ggplot(., aes(simulated)) + geom_density() + geom_vline(xintercept = c(-0.151, 0.738), linetype = "dashed")
scores2 %>%
ggplot(., aes(simulated)) + geom_density() + geom_vline(xintercept = c(-0.151, 0.738), linetype = "dashed")
## Created by: Eric William Shannon, PhD
## Date modified: 20190314
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190320.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(opp, stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
scores3 <- scores2
View(scores3)
frac_response <- lme4::glmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
family = "binomial", weights = g)
frac_response <- lme4::glmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
family = "binomial", weights = g, data = scores2)
install.packages("glmmadmb")
install.packages("R2admb")
install.packages("glmmADMB",
repos=c("http://glmmadmb.r-forge.r-project.org/repos",
getOption("repos")),
type="source")
library(glmmADMB)
frac_response <- glmmadmb(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
family = "binomial", data = scores2)
head(w_l_percent)
head(scores2$w_l_percent)
str(scores2$w_l_percent)
as.integer(scores2$w_l_percent)
hist(as.integer(scores2$w_l_percent))
remove.packages("glmmADMB")
View(scores2)
hist(scores2$w_l_percent)
frac_response <- lme4::lmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
family = "binomial", data = scores2)
frac_response <- lme4::lmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
?isSingular
## Created by: Eric William Shannon, PhD
## Date modified: 20190314
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190320.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(opp, stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
frac_response <- lme4::lmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
library(rstanarm)
?stan_lmer
rstanarm::stan_lmer(formula = w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2), data = scores2, prior = normal())
frac_response <- lme4::lmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
data = scores2)
View(frac_response)
frac_response <- lme4::lmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
data = scores3)
scores3 <- scores2
frac_response <- lme4::lmer(w_l_percent ~ sos + srs + DEFENSE + OFFENSE + (1 | V2),
data = scores3)
scores3$probability <- simulate(conference_effect, seed = 1, newdata = scores2,
allow.new.levels = TRUE, re.form = NA, cond.sim = FALSE)$sim_1
scores3$probability <- simulate(frac_response, seed = 1, newdata = scores3,
allow.new.levels = TRUE, re.form = NA, cond.sim = FALSE)$sim_1
View(scores3)
scores3 <-
scores3 %>% mutate_at(vars(OFFENSE, DEFENSE, probability), funs(round(. , 3)))
View(scores3)
## Created by: Eric William Shannon, PhD
## Date modified: 20190314
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
`%!in%` <- negate(`%in%`)
data2 <- openxlsx::read.xlsx("../data/20190320.xlsx", colNames = TRUE, startRow = 2)
data2 <- data2[, -1]
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
data2 <- data2[, -1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
data2 <- data2[(complete.cases(data2)), ]
data2 <- janitor::clean_names(data2)
offense_data <- data2 %>%
select(tm, pace, o_rtg, f_tr, x3p_ar, ts_percent, trb_percent, ast_percent, e_fg_percent, ft_fga)
pr_offense <- principal(offense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_offense <- as.data.frame(pr_offense$scores)
names(pr_offense)[names(pr_offense) == "PC1"] <- "OFFENSE"
defense_data <- data2 %>% select(opp, stl_percent, blk_percent, tov_percent, orb_percent)
pr_defense <- principal(defense_data, nfactors = 1, rotate = "varimax",
scores = TRUE, oblique.scores = FALSE, covar = TRUE)
pr_defense <- as.data.frame(pr_defense$scores)
names(pr_defense)[names(pr_defense) == "PC1"] <- "DEFENSE"
scores2 <- as.data.frame(cbind(data2, pr_offense, pr_defense))
scores2 <- scores2 %>% select(srs, w_l_percent, g, sos, OFFENSE, DEFENSE)
scores2 <- scores2 %>% rownames_to_column('V1')
scores2$V1 <- sub("^\\s+", "", scores2$V1)
scores2$V1 <- gsub("(^\\s+)|(\\s+$)", "", scores2$V1)
conf$V1 <- as.character(conf$V1)
conf$V1 <- sub("^\\s+", "", conf$V1)
conf$V1 <- gsub("(^\\s+)|(\\s+$)", "", conf$V1)
scores2 <- scores2 %>% left_join(conf)
haven::write_dta(scores2, "../workingdata/for_stata.dta")
haven::write_dta(scores2, "../workingdata/for_stata.dta", version = 13)
require(tidyverse)
require(ggplot2)
require(ggthemes)
require(psych)
library(tidyverse)
library(XML)
library(RCurl)
library(rlist)
dataurl <- getURL("https://www.sports-reference.com/cbb/seasons/2019-advanced-school-stats.html")
datatables <- readHTMLTable(dataurl)
datatables <- list.clean(datatables, fun = is.null, recursive = FALSE)
datatables <- do.call(rbind.data.frame, datatables)
View(datatables)
data2 <- data2[, -1]
rm(datatables)
dataurl <- getURL("https://www.sports-reference.com/cbb/seasons/2019-advanced-school-stats.html")
datatables <- readHTMLTable(dataurl)
datatables <- list.clean(datatables, fun = is.null, recursive = FALSE)
data2 <- do.call(rbind.data.frame, datatables)
data2 <- data2[, -1]
View(datatables)
View(data2)
conf <- read.csv("../data/teams.csv", header = FALSE)
rownames(data2) <- data2[, 1]
rownames(data2) <- gsub("NCAA", "", rownames(data2))
